import * as _syscalls2_0 from 'spacetime:sys@2.0';
import type { ModuleHooks } from 'spacetime:sys@2.0';
import { ConnectionId } from '../lib/connection_id';
import { Identity } from '../lib/identity';
import { Timestamp } from '../lib/timestamp';
import { Uuid } from '../lib/uuid';
import { type JsonObject, type JwtClaims } from '../lib/reducers';
import { type UntypedSchemaDef } from '../lib/schema';
import type { DbView } from './db_view';
import { type Random } from './rng';
import type { SchemaInner } from './schema';
export declare const sys: typeof _syscalls2_0;
export declare function parseJsonObject(json: string): JsonObject;
export declare const ReducerCtxImpl: {
    new <SchemaDef extends UntypedSchemaDef>(sender: Identity, timestamp: Timestamp, connectionId: ConnectionId | null, dbView: DbView<any>): {
        "__#private@#identity": Identity | undefined;
        "__#private@#senderAuth": Readonly<{
            isInternal: boolean;
            hasJWT: boolean;
            jwt: JwtClaims | null;
        }> | undefined;
        "__#private@#uuidCounter": {
            value: number;
        } | undefined;
        "__#private@#random": Random | undefined;
        sender: Identity;
        timestamp: Timestamp;
        connectionId: ConnectionId | null;
        db: DbView<SchemaDef>;
        get identity(): Identity;
        get senderAuth(): Readonly<{
            isInternal: boolean;
            hasJWT: boolean;
            jwt: JwtClaims | null;
        }>;
        get random(): Random;
        /**
         * Create a new random {@link Uuid} `v4` using this `ReducerCtx`'s RNG.
         */
        newUuidV4(): Uuid;
        /**
         * Create a new sortable {@link Uuid} `v7` using this `ReducerCtx`'s RNG, counter,
         * and timestamp.
         */
        newUuidV7(): Uuid;
    };
    /** Reset the `ReducerCtx` to be used for a new transaction */
    reset(me: InstanceType</*elided*/ any>, sender: Identity, timestamp: Timestamp, connectionId: ConnectionId | null): void;
};
/**
 * Call into a user function `fn` - the backtrace from an exception thrown in
 * `fn` or one of its descendants in the callgraph will be stripped by host
 * code in `crates/core/src/host/v8/error.rs` such that `fn` will be shown to
 * be the root of the call stack.
 */
export declare const callUserFunction: <Args extends any[], R>(fn: (...args: Args) => R, ...args: Args) => R;
export declare const makeHooks: (schema: SchemaInner) => ModuleHooks;
//# sourceMappingURL=runtime.d.ts.map